/*!
 * jQuery UI Dialog @VERSION
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","./button","./draggable","./mouse","./resizable","../focusable","../keycode","../position","../safe-active-element","../safe-blur","../tabbable","../unique-id","../version","../widget"],a)}else{a(jQuery)}}(function(a){a.widget("ui.dialog",{version:"@VERSION",options:{appendTo:"body",autoOpen:true,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:true,closeText:"Close",draggable:true,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",of:window,collision:"fit",using:function(c){var b=a(this).css(c).offset().top;if(b<0){a(this).css("top",c.top-b)}}},resizable:true,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},resizableRelatedOptions:{maxHeight:true,maxWidth:true,minHeight:true,minWidth:true},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.originalTitle=this.element.attr("title");if(this.options.title==null&&this.originalTitle!=null){this.options.title=this.originalTitle}if(this.options.disabled){this.options.disabled=false}this._createWrapper();this.element.show().removeAttr("title").appendTo(this.uiDialog);this._addClass("ui-dialog-content","ui-widget-content");this._createTitlebar();this._createButtonPane();if(this.options.draggable&&a.fn.draggable){this._makeDraggable()}if(this.options.resizable&&a.fn.resizable){this._makeResizable()}this._isOpen=false;this._trackFocus()},_init:function(){if(this.options.autoOpen){this.open()}},_appendTo:function(){var b=this.options.appendTo;if(b&&(b.jquery||b.nodeType)){return a(b)}return this.document.find(b||"body").eq(0)},_destroy:function(){var c,b=this.originalPosition;this._untrackInstance();this._destroyOverlay();this.element.removeUniqueId().css(this.originalCss).detach();this.uiDialog.remove();if(this.originalTitle){this.element.attr("title",this.originalTitle)}c=b.parent.children().eq(b.index);if(c.length&&c[0]!==this.element[0]){c.before(this.element)}else{b.parent.append(this.element)}},widget:function(){return this.uiDialog},disable:a.noop,enable:a.noop,close:function(c){var b=this;if(!this._isOpen||this._trigger("beforeClose",c)===false){return}this._isOpen=false;this._focusedElement=null;this._destroyOverlay();this._untrackInstance();if(!this.opener.filter(":focusable").trigger("focus").length){a.ui.safeBlur(a.ui.safeActiveElement(this.document[0]))}this._hide(this.uiDialog,this.options.hide,function(){b._trigger("close",c)})},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(f,b){var e=false,d=this.uiDialog.siblings(".ui-front:visible").map(function(){return +a(this).css("z-index")}).get(),c=Math.max.apply(null,d);if(c>=+this.uiDialog.css("z-index")){this.uiDialog.css("z-index",c+1);e=true}if(e&&!b){this._trigger("focus",f)}return e},open:function(){var b=this;if(this._isOpen){if(this._moveToTop()){this._focusTabbable()}return}this._isOpen=true;this.opener=a(a.ui.safeActiveElement(this.document[0]));this._size();this._position();this._createOverlay();this._moveToTop(null,true);if(this.overlay){this.overlay.css("z-index",this.uiDialog.css("z-index")-1)}this._show(this.uiDialog,this.options.show,function(){b._focusTabbable();b._trigger("focus")});this._makeFocusTarget();this._trigger("open")},_focusTabbable:function(){var b=this._focusedElement;if(!b){b=this.element.find("[autofocus]")}if(!b.length){b=this.element.find(":tabbable")}if(!b.length){b=this.uiDialogButtonPane.find(":tabbable")}if(!b.length){b=this.uiDialogTitlebarClose.filter(":tabbable")}if(!b.length){b=this.uiDialog}b.eq(0).trigger("focus")},_keepFocus:function(b){function c(){var e=a.ui.safeActiveElement(this.document[0]),d=this.uiDialog[0]===e||a.contains(this.uiDialog[0],e);if(!d){this._focusTabbable()}}b.preventDefault();c.call(this);this._delay(c)},_createWrapper:function(){this.uiDialog=a("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo());this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front");this._on(this.uiDialog,{keydown:function(d){if(this.options.closeOnEscape&&!d.isDefaultPrevented()&&d.keyCode&&d.keyCode===a.ui.keyCode.ESCAPE){d.preventDefault();this.close(d);return}if(d.keyCode!==a.ui.keyCode.TAB||d.isDefaultPrevented()){return}var c=this.uiDialog.find(":tabbable"),e=c.filter(":first"),b=c.filter(":last");if((d.target===b[0]||d.target===this.uiDialog[0])&&!d.shiftKey){this._delay(function(){e.trigger("focus")});d.preventDefault()}else{if((d.target===e[0]||d.target===this.uiDialog[0])&&d.shiftKey){this._delay(function(){b.trigger("focus")});d.preventDefault()}}},mousedown:function(b){if(this._moveToTop(b)){this._focusTabbable()}}});if(!this.element.find("[aria-describedby]").length){this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})}},_createTitlebar:function(){var b;this.uiDialogTitlebar=a("<div>");this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix");this._on(this.uiDialogTitlebar,{mousedown:function(c){if(!a(c.target).closest(".ui-dialog-titlebar-close")){this.uiDialog.trigger("focus")}}});this.uiDialogTitlebarClose=a("<button type='button'></button>").button({label:a("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:false}).appendTo(this.uiDialogTitlebar);this._addClass(this.uiDialogTitlebarClose,"ui-dialog-titlebar-close");this._on(this.uiDialogTitlebarClose,{click:function(c){c.preventDefault();this.close(c)}});b=a("<span>").uniqueId().prependTo(this.uiDialogTitlebar);this._addClass(b,"ui-dialog-title");this._title(b);this.uiDialogTitlebar.prependTo(this.uiDialog);this.uiDialog.attr({"aria-labelledby":b.attr("id")})},_title:function(b){if(this.options.title){b.text(this.options.title)}else{b.html("&#160;")}},_createButtonPane:function(){this.uiDialogButtonPane=a("<div>");this._addClass(this.uiDialogButtonPane,"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix");this.uiButtonSet=a("<div>").appendTo(this.uiDialogButtonPane);this._addClass(this.uiButtonSet,"ui-dialog-buttonset");this._createButtons()},_createButtons:function(){var c=this,b=this.options.buttons;this.uiDialogButtonPane.remove();this.uiButtonSet.empty();if(a.isEmptyObject(b)||(a.isArray(b)&&!b.length)){this._removeClass(this.uiDialog,"ui-dialog-buttons");return}a.each(b,function(d,e){var f,g;e=a.isFunction(e)?{click:e,text:d}:e;e=a.extend({type:"button"},e);f=e.click;g={icon:e.icon,iconPosition:e.iconPosition,showLabel:e.showLabel,icons:e.icons,text:e.text};delete e.click;delete e.icon;delete e.iconPosition;delete e.showLabel;delete e.icons;if(typeof e.text==="boolean"){delete e.text}a("<button></button>",e).button(g).appendTo(c.uiButtonSet).on("click",function(){f.apply(c.element[0],arguments)})});this._addClass(this.uiDialog,"ui-dialog-buttons");this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){var d=this,c=this.options;function b(e){return{position:e.position,offset:e.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(e,f){d._addClass(a(this),"ui-dialog-dragging");d._blockFrames();d._trigger("dragStart",e,b(f))},drag:function(e,f){d._trigger("drag",e,b(f))},stop:function(e,f){var h=f.offset.left-d.document.scrollLeft(),g=f.offset.top-d.document.scrollTop();c.position={my:"left top",at:"left"+(h>=0?"+":"")+h+" top"+(g>=0?"+":"")+g,of:d.window};d._removeClass(a(this),"ui-dialog-dragging");d._unblockFrames();d._trigger("dragStop",e,b(f))}})},_makeResizable:function(){var g=this,e=this.options,f=e.resizable,b=this.uiDialog.css("position"),d=typeof f==="string"?f:"n,e,s,w,se,sw,ne,nw";function c(h){return{originalPosition:h.originalPosition,originalSize:h.originalSize,position:h.position,size:h.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:e.maxWidth,maxHeight:e.maxHeight,minWidth:e.minWidth,minHeight:this._minHeight(),handles:d,start:function(h,i){g._addClass(a(this),"ui-dialog-resizing");g._blockFrames();g._trigger("resizeStart",h,c(i))},resize:function(h,i){g._trigger("resize",h,c(i))},stop:function(h,i){var l=g.uiDialog.offset(),k=l.left-g.document.scrollLeft(),j=l.top-g.document.scrollTop();e.height=g.uiDialog.height();e.width=g.uiDialog.width();e.position={my:"left top",at:"left"+(k>=0?"+":"")+k+" top"+(j>=0?"+":"")+j,of:g.window};g._removeClass(a(this),"ui-dialog-resizing");g._unblockFrames();g._trigger("resizeStop",h,c(i))}}).css("position",b)},_trackFocus:function(){this._on(this.widget(),{focusin:function(b){this._makeFocusTarget();this._focusedElement=a(b.target)}})},_makeFocusTarget:function(){this._untrackInstance();this._trackingInstances().unshift(this)},_untrackInstance:function(){var c=this._trackingInstances(),b=a.inArray(this,c);if(b!==-1){c.splice(b,1)}},_trackingInstances:function(){var b=this.document.data("ui-dialog-instances");if(!b){b=[];this.document.data("ui-dialog-instances",b)}return b},_minHeight:function(){var b=this.options;return b.height==="auto"?b.minHeight:Math.min(b.minHeight,b.height)},_position:function(){var b=this.uiDialog.is(":visible");if(!b){this.uiDialog.show()}this.uiDialog.position(this.options.position);if(!b){this.uiDialog.hide()}},_setOptions:function(d){var e=this,c=false,b={};a.each(d,function(f,g){e._setOption(f,g);if(f in e.sizeRelatedOptions){c=true}if(f in e.resizableRelatedOptions){b[f]=g}});if(c){this._size();this._position()}if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option",b)}},_setOption:function(d,e){var c,f,b=this.uiDialog;if(d==="disabled"){return}this._super(d,e);if(d==="appendTo"){this.uiDialog.appendTo(this._appendTo())}if(d==="buttons"){this._createButtons()}if(d==="closeText"){this.uiDialogTitlebarClose.button({label:a("<a>").text(""+this.options.closeText).html()})}if(d==="draggable"){c=b.is(":data(ui-draggable)");if(c&&!e){b.draggable("destroy")}if(!c&&e){this._makeDraggable()}}if(d==="position"){this._position()}if(d==="resizable"){f=b.is(":data(ui-resizable)");if(f&&!e){b.resizable("destroy")}if(f&&typeof e==="string"){b.resizable("option","handles",e)}if(!f&&e!==false){this._makeResizable()}}if(d==="title"){this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))}},_size:function(){var b,d,e,c=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0});if(c.minWidth>c.width){c.width=c.minWidth}b=this.uiDialog.css({height:"auto",width:c.width}).outerHeight();d=Math.max(0,c.minHeight-b);e=typeof c.maxHeight==="number"?Math.max(0,c.maxHeight-b):"none";if(c.height==="auto"){this.element.css({minHeight:d,maxHeight:e,height:"auto"})}else{this.element.height(Math.max(0,c.height-b))}if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight())}},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var b=a(this);return a("<div>").css({position:"absolute",width:b.outerWidth(),height:b.outerHeight()}).appendTo(b.parent()).offset(b.offset())[0]})},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks}},_allowInteraction:function(b){if(a(b.target).closest(".ui-dialog").length){return true}return !!a(b.target).closest(".ui-datepicker").length},_createOverlay:function(){if(!this.options.modal){return}var b=true;this._delay(function(){b=false});if(!this.document.data("ui-dialog-overlays")){this._on(this.document,{focusin:function(c){if(b){return}if(!this._allowInteraction(c)){c.preventDefault();this._trackingInstances()[0]._focusTabbable()}}})}this.overlay=a("<div>").appendTo(this._appendTo());this._addClass(this.overlay,null,"ui-widget-overlay ui-front");this._on(this.overlay,{mousedown:"_keepFocus"});this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1)},_destroyOverlay:function(){if(!this.options.modal){return}if(this.overlay){var b=this.document.data("ui-dialog-overlays")-1;if(!b){this._off(this.document,"focusin");this.document.removeData("ui-dialog-overlays")}else{this.document.data("ui-dialog-overlays",b)}this.overlay.remove();this.overlay=null}}});if(a.uiBackCompat!==false){a.widget("ui.dialog",a.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super();this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(b,c){if(b==="dialogClass"){this.uiDialog.removeClass(this.options.dialogClass).addClass(c)}this._superApply(arguments)}})}return a.ui.dialog}));