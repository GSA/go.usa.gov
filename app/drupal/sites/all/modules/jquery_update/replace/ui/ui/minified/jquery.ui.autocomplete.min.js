/*!
 * jQuery UI Autocomplete @VERSION
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery","./menu","../keycode","../position","../safe-active-element","../version","../widget"],a)}else{a(jQuery)}}(function(a){a.widget("ui.autocomplete",{version:"@VERSION",defaultElement:"<input>",options:{appendTo:null,autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var d,b,e,g=this.element[0].nodeName.toLowerCase(),f=g==="textarea",c=g==="input";this.isMultiLine=f||!c&&this._isContentEditable(this.element);this.valueMethod=this.element[f||c?"val":"text"];this.isNewMenu=true;this._addClass("ui-autocomplete-input");this.element.attr("autocomplete","off");this._on(this.element,{keydown:function(h){if(this.element.prop("readOnly")){d=true;e=true;b=true;return}d=false;e=false;b=false;var i=a.ui.keyCode;switch(h.keyCode){case i.PAGE_UP:d=true;this._move("previousPage",h);break;case i.PAGE_DOWN:d=true;this._move("nextPage",h);break;case i.UP:d=true;this._keyEvent("previous",h);break;case i.DOWN:d=true;this._keyEvent("next",h);break;case i.ENTER:if(this.menu.active){d=true;h.preventDefault();this.menu.select(h)}break;case i.TAB:if(this.menu.active){this.menu.select(h)}break;case i.ESCAPE:if(this.menu.element.is(":visible")){if(!this.isMultiLine){this._value(this.term)}this.close(h);h.preventDefault()}break;default:b=true;this._searchTimeout(h);break}},keypress:function(h){if(d){d=false;if(!this.isMultiLine||this.menu.element.is(":visible")){h.preventDefault()}return}if(b){return}var i=a.ui.keyCode;switch(h.keyCode){case i.PAGE_UP:this._move("previousPage",h);break;case i.PAGE_DOWN:this._move("nextPage",h);break;case i.UP:this._keyEvent("previous",h);break;case i.DOWN:this._keyEvent("next",h);break}},input:function(h){if(e){e=false;h.preventDefault();return}this._searchTimeout(h)},focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(h){if(this.cancelBlur){delete this.cancelBlur;return}clearTimeout(this.searching);this.close(h);this._change(h)}});this._initSource();this.menu=a("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().menu("instance");this._addClass(this.menu.element,"ui-autocomplete","ui-front");this._on(this.menu.element,{mousedown:function(h){h.preventDefault();this.cancelBlur=true;this._delay(function(){delete this.cancelBlur;if(this.element[0]!==a.ui.safeActiveElement(this.document[0])){this.element.trigger("focus")}})},menufocus:function(j,k){var h,i;if(this.isNewMenu){this.isNewMenu=false;if(j.originalEvent&&/^mouse/.test(j.originalEvent.type)){this.menu.blur();this.document.one("mousemove",function(){a(j.target).trigger(j.originalEvent)});return}}i=k.item.data("ui-autocomplete-item");if(false!==this._trigger("focus",j,{item:i})){if(j.originalEvent&&/^key/.test(j.originalEvent.type)){this._value(i.value)}}h=k.item.attr("aria-label")||i.value;if(h&&a.trim(h).length){this.liveRegion.children().hide();a("<div>").text(h).appendTo(this.liveRegion)}},menuselect:function(j,k){var i=k.item.data("ui-autocomplete-item"),h=this.previous;if(this.element[0]!==a.ui.safeActiveElement(this.document[0])){this.element.trigger("focus");this.previous=h;this._delay(function(){this.previous=h;this.selectedItem=i})}if(false!==this._trigger("select",j,{item:i})){this._value(i.value)}this.term=this._value();this.close(j);this.selectedItem=i}});this.liveRegion=a("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body);this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible");this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove()},_setOption:function(b,c){this._super(b,c);if(b==="source"){this._initSource()}if(b==="appendTo"){this.menu.element.appendTo(this._appendTo())}if(b==="disabled"&&c&&this.xhr){this.xhr.abort()}},_isEventTargetInWidget:function(b){var c=this.menu.element[0];return b.target===this.element[0]||b.target===c||a.contains(c,b.target)},_closeOnClickOutside:function(b){if(!this._isEventTargetInWidget(b)){this.close()}},_appendTo:function(){var b=this.options.appendTo;if(b){b=b.jquery||b.nodeType?a(b):this.document.find(b).eq(0)}if(!b||!b[0]){b=this.element.closest(".ui-front, dialog")}if(!b.length){b=this.document[0].body}return b},_initSource:function(){var d,b,c=this;if(a.isArray(this.options.source)){d=this.options.source;this.source=function(f,e){e(a.ui.autocomplete.filter(d,f.term))}}else{if(typeof this.options.source==="string"){b=this.options.source;this.source=function(f,e){if(c.xhr){c.xhr.abort()}c.xhr=a.ajax({url:b,data:f,dataType:"json",success:function(g){e(g)},error:function(){e([])}})}}else{this.source=this.options.source}}},_searchTimeout:function(b){clearTimeout(this.searching);this.searching=this._delay(function(){var d=this.term===this._value(),c=this.menu.element.is(":visible"),e=b.altKey||b.ctrlKey||b.metaKey||b.shiftKey;if(!d||(d&&!c&&!e)){this.selectedItem=null;this.search(null,b)}},this.options.delay)},search:function(c,b){c=c!=null?c:this._value();this.term=this._value();if(c.length<this.options.minLength){return this.close(b)}if(this._trigger("search",b)===false){return}return this._search(c)},_search:function(b){this.pending++;this._addClass("ui-autocomplete-loading");this.cancelSearch=false;this.source({term:b},this._response())},_response:function(){var b=++this.requestIndex;return a.proxy(function(c){if(b===this.requestIndex){this.__response(c)}this.pending--;if(!this.pending){this._removeClass("ui-autocomplete-loading")}},this)},__response:function(b){if(b){b=this._normalize(b)}this._trigger("response",null,{content:b});if(!this.options.disabled&&b&&b.length&&!this.cancelSearch){this._suggest(b);this._trigger("open")}else{this._close()}},close:function(b){this.cancelSearch=true;this._close(b)},_close:function(b){this._off(this.document,"mousedown");if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.blur();this.isNewMenu=true;this._trigger("close",b)}},_change:function(b){if(this.previous!==this._value()){this._trigger("change",b,{item:this.selectedItem})}},_normalize:function(b){if(b.length&&b[0].label&&b[0].value){return b}return a.map(b,function(c){if(typeof c==="string"){return{label:c,value:c}}return a.extend({},c,{label:c.label||c.value,value:c.value||c.label})})},_suggest:function(b){var c=this.menu.element.empty();this._renderMenu(c,b);this.isNewMenu=true;this.menu.refresh();c.show();this._resizeMenu();c.position(a.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next()}this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var b=this.menu.element;b.outerWidth(Math.max(b.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(c,b){var d=this;a.each(b,function(e,f){d._renderItemData(c,f)})},_renderItemData:function(b,c){return this._renderItem(b,c).data("ui-autocomplete-item",c)},_renderItem:function(b,c){return a("<li>").append(a("<div>").text(c.label)).appendTo(b)},_move:function(c,b){if(!this.menu.element.is(":visible")){this.search(null,b);return}if(this.menu.isFirstItem()&&/^previous/.test(c)||this.menu.isLastItem()&&/^next/.test(c)){if(!this.isMultiLine){this._value(this.term)}this.menu.blur();return}this.menu[c](b)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(c,b){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(c,b);b.preventDefault()}},_isContentEditable:function(c){if(!c.length){return false}var b=c.prop("contentEditable");if(b==="inherit"){return this._isContentEditable(c.parent())}return b==="true"}});a.extend(a.ui.autocomplete,{escapeRegex:function(b){return b.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(d,b){var c=new RegExp(a.ui.autocomplete.escapeRegex(b),"i");return a.grep(d,function(e){return c.test(e.label||e.value||e)})}});a.widget("ui.autocomplete",a.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(b){return b+(b>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(c){var b;this._superApply(arguments);if(this.options.disabled||this.cancelSearch){return}if(c&&c.length){b=this.options.messages.results(c.length)}else{b=this.options.messages.noResults}this.liveRegion.children().hide();a("<div>").text(b).appendTo(this.liveRegion)}});return a.ui.autocomplete}));